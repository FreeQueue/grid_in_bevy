# Tilemap设计

## Tilemap基本概念

### 设想

类饥荒地图，多了无限属性和更复杂的建筑物：

1. Tilemap是一个无限的二维数组，每个元素是一个Tile。
2. Tile按Chunk进行分组管理。
3. Chunk可以显示在屏幕上，显示的区域称为View。
4. Unit可以在Tilemap上移动。
5. Structure占有固定形状的一堆Tile，Structure之间不能占用同一块Tile，这个形状被称为Shape
6. Structure必须有一个中心点（也是生成位置）来决定属于哪个Chunk，Structure不可以比Chunk大。
7. 一个世界中可以有多个Tilemap，实现多个维度（Dimension），一个存档有一个世界


1. 可以考虑实现特殊的地图类型，比如有限世界，四方连续世界
2. 有水体
3. 生物群系概念
4. 根据地形来生成结构

### 否决

1. 实现纬度
2. 

### 概念总结：

1. Save

   存档，记录一场游戏的所有信息，
2. World

   世界，一个存档有一个世界，世界除了维度信息之外，还存储世界种子，创建时间，玩家信息等
3. Dimension

   维度，一个世界有多个维度，维度除了Tilemap之外，还有一些专属于维度的信息，比如时间，天气等
4. Tilemap

   瓦片地图，记录了所有的Chunk信息，
5. View

   只有符号View渲染条件的Chuck会被渲染
6. Chuck

   用于分组优化，可能有多种分组级别
7. Shape

   用于Structure的占用
8. Tile

   瓦片，构成瓦片地图的基础单位
9. Unit

   单位自由移动，
10. Structure

   结构，占用一定的Tile，有一个中心点，可以是单位，也可以是Tilemap的一部分

## Tilemap使用场景设想

### 生成、序列化和反序列化

1. 在View中，未生成的Chunk使用随机算法和Seed决定每一个Tile。
2. 在View中，已生成的Chunk读取序列化的数据进行生成。
3. 离开View的Chuck会被卸载，并序列化。
4. 有没有可能只记录修改过的Tile并结合随机算法进行生成？
5. 需要一个重新生成命令，可以让版本不同的随机算法重新生成Chunk，刷新资源

### 建筑

1. 可以在上放置Structure

### 移动

1. 单位可以在Tilemap上移动。

### 高度？

1. 是否应该有高度属性，只有在高于高度的单位才能通过，低于高度的单位不能通过。
2. 高度设计应该分为有限的几种枚举，而不是实际的浮点数高度

### 显示

## 策略

### 加载策略

## 怎么设计Tilemap的数据结构
